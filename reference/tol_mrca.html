<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MRCA of taxa from the synthetic tree — tol_mrca • rotl</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>



<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- ropensci -->
<link href="../ropensci.css?nocache=123" rel="stylesheet">

<meta property="og:title" content="MRCA of taxa from the synthetic tree — tol_mrca" />
<meta property="og:description" content="Most Recent Common Ancestor for a set of nodes" />
<meta name="twitter:card" content="summary" />






<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci" /></a>
        <a class="navbar-brand" href="../index.html"><i>rotl <small>v3.0.10.9000</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rotl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_mashups.html">Connecting data to Open Tree trees</a>
    </li>
    <li>
      <a href="../articles/meta-analysis.html">Using the Open Tree synthesis in a comparative analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ropensci/rotl/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MRCA of taxa from the synthetic tree</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/rotl/blob/master/R/tol.R'><code>R/tol.R</code></a></small>
    <div class="hidden name"><code>tol_mrca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Most Recent Common Ancestor for a set of nodes</p>
    </div>

    <pre class="usage"><span class='fu'>tol_mrca</span>(<span class='kw'>ott_ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>node_ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='taxonomy-methods.html'>tax_sources</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='taxonomy-methods.html'>unique_name</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='taxonomy-methods.html'>tax_name</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='taxonomy-methods.html'>tax_rank</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='taxonomy-methods.html'>ott_id</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)

<span class='co'># S3 method for tol_mrca</span>
<span class='fu'><a href='source_list.html'>source_list</a></span>(<span class='no'>tax</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ott_ids</th>
      <td><p>Numeric vector. The ott ids for which the MRCA is desired.</p></td>
    </tr>
    <tr>
      <th>node_ids</th>
      <td><p>Character vector. The node ids for which the MRCA is desired.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to customize the API call (see
<code><a href='rotl.html'>rotl</a></code> for more information).</p></td>
    </tr>
    <tr>
      <th>tax</th>
      <td><p>an object returned by <code>tol_mrca()</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An invisible list of the MRCA node properties:</p>
<ul>
<li><p>mrca List of node properties.</p>
<p></p><ul>
<li><p>node_id String. The canonical identifier of the node.</p></li>
<li><p>num_tips Numeric. The number of descendent tips.</p></li>
<li><p>taxon A list of taxonomic properties. Only returned if
        the queried node is a taxon. (If the node is not a taxon, a
        <code>nearest_taxon</code> list is returned (see below)).</p>
<p></p><ul>
<li><p>ott_id Numeric. The OpenTree Taxonomy ID (ottID).</p></li>
<li><p>name String. The taxonomic name of the queried node.</p></li>
<li><p>unique_name String. The string that uniquely
                identifies the taxon in OTT.</p></li>
<li><p>rank String. The taxonomic rank of the taxon in OTT.</p></li>
<li><p>tax_sources List. A list of identifiers for taxonomic
                sources, such as other taxonomies, that define taxa judged
                equivalent to this taxon.</p></li>
</ul>

<p>The following properties list support/conflict for the node across
        synthesis source trees. All properties involve sourceid keys and
        nodeid values (see <code>source_id_map</code> below) Not all properties are
        are present for every node.</p></li>
<li><p>partial_path_of List. The edge below this synthetic tree node
        is compatible with the edge below each of these input tree nodes (one
        per tree). Each returned element is reported as sourceid:nodeid.</p></li>
<li><p>supported_by List. Input tree nodes (one per tree) that support
        this synthetic tree node. Each returned element is reported as
        sourceid:nodeid.</p></li>
<li><p>terminal List. Input tree nodes (one per tree) that are equivalent
        to this synthetic tree node (via an exact mapping, or the input tree
        terminal may be the only terminal descended from this synthetic tree node.
        Each returned element is reported as sourceid:nodeid.</p></li>
<li><p>conflicts_with Named list of lists. Names correspond to
        sourceid keys. Each list contains input tree node ids (one or more per tree)
        that conflict with this synthetic node.</p></li>
</ul></li>
<li><p>nearest_taxon A list of taxonomic properties of the nearest rootward
    taxon node to the MRCA node. Only returned if the MRCA node is a not taxon
    (otherwise the <code>taxon</code> list above is returned).</p>
<p></p><ul>
<li><p>ott_id Numeric. The OpenTree Taxonomy ID (ottID).</p></li>
<li><p>name String. The taxonomic name of the queried node.</p></li>
<li><p>unique_name String. The string that uniquely
            identifies the taxon in OTT.</p></li>
<li><p>rank String. The taxonomic rank of the taxon in OTT.</p></li>
<li><p>tax_sources List. A list of identifiers for taxonomic
            sources, such as other taxonomies, that define taxa judged
            equivalent to this taxon.</p></li>
</ul></li>
<li><p>source_id_map Named list of lists. Names correspond to the
    sourceid keys used in the support/conflict properties of the <code>mrca</code>
    list above. Source trees will have the following properties:</p>
<p></p><ul>
<li><p>git_sha The git SHA identifying a particular source
            version.</p></li>
<li><p>tree_id The tree id associated with the study id used.</p></li>
<li><p>study_id The study identifier. Will typically include
            a prefix ("pg_" or "ot_").</p></li>
</ul><p>The only sourceid that does not correspond to a source tree is the taxonomy,
    which will have the name "ott"+`taxonomy_version`, and the value is the
    ott_id of the taxon in that taxonomy version. "Taxonomy" will only ever
    appear in <code>supported_by</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Get the MRCA of a set of nodes on the current synthetic
    tree. Accepts any combination of node ids and ott ids as
    input. Returns information about the most recent common
    ancestor (MRCA) node as well as the most recent taxonomic
    ancestor (MRTA) node (the closest taxonomic node to the MRCA
    node in the synthetic tree; the MRCA and MRTA may be the same
    node). If they are the same, the taxonomic information will be
    in the <code>mrca</code> slot, otherwise they will be in the
    <code>nearest_taxon</code> slot of the list. If any of the specified
    nodes is not in the synthetic tree an error will be returned.</p>
<p>Taxonomic methods (<code><a href='taxonomy-methods.html'>tax_sources()</a></code>, <code><a href='taxonomy-methods.html'>ott_id()</a></code>,
    <code><a href='taxonomy-methods.html'>unique_name()</a></code>, ...) are available on the objects
    returned by <code>tol_mrca()</code>. If the MRCA node is MRTA, the
    name of the object returned by these methods will start with
    &#8216;ott&#8217;, otherwise it will start with &#8216;mrca&#8217;.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>birds_mrca</span> <span class='kw'>&lt;-</span> <span class='fu'>tol_mrca</span>(<span class='kw'>ott_ids</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>412129</span>, <span class='fl'>119214</span>))
<span class='fu'><a href='taxonomy-methods.html'>ott_id</a></span>(<span class='no'>birds_mrca</span>)
<span class='fu'><a href='taxonomy-methods.html'>tax_sources</a></span>(<span class='no'>birds_mrca</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <!-- begin footer -->
<div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg" /></div>
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/ropensci" target="_blank"><div class="icon fab fa-github"></div></a>
                        <a href="http://github.com/ropenscilabs" target="_blank"><div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/ropensci" target="_blank"><div class="icon fab fa-twitter"></div></a>
                        <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">Info</h5>
                            <li><a href="https://ropensci.org/about">Mission</a></li>
                            <li><a href="https://ropensci.org/about#team">Team</a></li>
                            <li><a href="https://ropensci.org/about#collaborators">Collaborators</a></li>
                            <li><a href="https://ropensci.org/careers">Careers</a></li>
                        </ul>
                    </div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">Work</h5>
                            <li><a href="https://ropensci.org/packages/">Packages</a></li>
                            <li><a href="https://ropensci.org/blog/">Blog</a></li>
                            <li><a href="https://ropensci.org/technotes/">Tech Notes</a></li>
                            <li><a href="https://ropensci.org/tutorials/">Tutorials</a></li>
                            <li><a href="https://ropensci.org/usecases/">Use Cases</a></li>
                            <li><a href="https://ropensci.org/resources/">More Resources</a></li>
                        </ul>
                    </div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
                            <h5 class="bottom-2">Participate</h5>
                            <li><a href="https://ropensci.org/contact/">Contact us</a></li>
                            <li><a href="https://ropensci.org/community/">Community</a></li>
                            <li><a href="https://ropensci.org/software-review/">Contribute software</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct">Code of conduct</a></li>
                            <li><a href="https://ropensci.org/events/">Events</a></li>
                            <li><a href="https://ropensci.org/commcalls/">Community calls</a></li>
                            <li><a href="https://ropensci.org/donate/">Donate</a></li>
                        </ul>
                    </div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                        <a href="http://numfocus.org" target="_blank"></a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
   </div>

  


  </body>
</html>


